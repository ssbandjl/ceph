local_delivery_thread: 本地快速分发
dispatch_throttler 分发器节流阀: 节流阻止我们建立大量等待调度的积压

Stack是一个网络IO框架，封装了所有必要的基础网络接口，然后它管理线程工作。posix、dpdk甚至RDMA等不同的网络后端都需要继承Stack类来实现必要的接口。 所以这会让其他人轻松网络后端集成到 ceph 中。 否则，每个后端都需要实现整个 Messenger 逻辑，如重新连接、策略处理、会话维持...

分配大页面
1. 使用 HUGE_PAGE_SIZE_2MB 用于 2MB 页面对齐。
2. 使用 ALIGN_TO_PAGE_2MB 将请求大小对齐为 2MB

端口属性 port_attr
(gdb) p port_attr
$22 = {
  state = IBV_PORT_ACTIVE, 
  max_mtu = IBV_MTU_4096, 
  active_mtu = IBV_MTU_1024, 
  gid_tbl_len = 255, 
  port_cap_flags = 67174400, 
  max_msg_sz = 1073741824, 
  bad_pkey_cntr = 0, 
  qkey_viol_cntr = 0, 
  pkey_tbl_len = 1, 
  lid = 0, 
---Type <return> to continue, or q <return> to quit---
  sm_lid = 0, 
  lmc = 0 '\000', 
  max_vl_num = 0 '\000', 
  sm_sl = 0 '\000', 
  subnet_timeout = 0 '\000', 
  init_type_reply = 0 '\000', 
  active_width = 2 '\002', 
  active_speed = 32 ' ', 
  phys_state = 5 '\005', 
  link_layer = 2 '\002', 
  flags = 1 '\001', 
---Type <return> to continue, or q <return> to quit---
  port_cap_flags2 = 0
}

获取当前时间: static time_point now()

增加引用计数:  w->get_perf_counter()->inc(l_msgr_active_connections)


Ceph Manager 守护进程 (ceph-mgr) 与监控守护进程一起运行，为外部监控和管理系统提供额外的监控和接口。
monitor daemons

性能统计:
https://docs.ceph.com/en/latest/dev/perf_counters/
说明: https://www.modb.pro/db/135643
用户和开发人员还可以在本地访问性能计数器数据，以检查集群的整体健康状况、识别工作负载模式、按守护程序类型监控集群性能，以及解决延迟、节流、内存管理等问题（参见访问）
性能计数器数据通过管理套接字访问:
ceph daemon osd.0 perf schema
ceph daemon osd.0 perf dump
ceph daemon {daemon id} counter dump
ceph daemon {daemon id} counter schema
ceph daemon {daemon id} perf dump
ceph daemon DAEMON_NAME perf schema
ceph daemon DAEMON_NAME perf dump
ceph daemon mon.`hostname -s` perf schema
ceph daemon perf dump objecter

查看连接数: 
ceph daemon osd.0 perf dump objecter|grep session

https://www.cnblogs.com/yanling-coder/p/12620005.html
查看配置:
ceph daemon osd.0 config show

设置:
# 使用 daemon 进行设置的方式就是一个个的去设置，这样可以比较好的反馈，此方法是需要在设置的角色所在的主机上进行设置。
命令格式：
ceph daemon {daemon-type}.{id} config set {name}={value}
命令举例：
ceph daemon mon.ceph-monitor-1 config set mon_allow_pool_delete false


内部节流机制会报告有关其节流方式的统计信息:
throttle-msgr_dispatch_throttler-hbserver
throttle-msgr_dispatch_throttler-client
throttle-filestore_bytes


class ObjectExtent
Using src
verifying file...
